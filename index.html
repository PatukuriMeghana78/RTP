<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Colorblindness Daltonization Tool</title>
  <style>
    body { font-family: sans-serif; padding: 2rem; background: #f9f9f9; }
    h1 { color: #333; }
    .container { display: flex; flex-direction: column; gap: 1rem; }
    .preview { display: flex; gap: 2rem; flex-wrap: wrap; }
    img { max-width: 300px; border: 1px solid #ccc; padding: 5px; }
    button { padding: 0.5rem 1rem; }
  </style>
</head>
<body>
  <h1>Daltonize Image for Colorblind Accessibility</h1>
  <div class="container">
    <input type="file" id="upload" accept="image/*">
    <select id="type">
      <option value="d">Deuteranopia</option>
      <option value="p">Protanopia</option>
      <option value="t">Tritanopia</option>
    </select>
    <button onclick="submitImage()">Daltonize</button>

    <div class="preview">
      <div>
        <h3>Original</h3>
        <img id="original" src="#" alt="Original Image" style="display:none;">
      </div>
      <div>
        <h3>Daltonized</h3>
        <img id="daltonized" src="#" alt="Daltonized Image" style="display:none;">
      </div>
    </div>
  </div>

  <script>
    let imageFile = null;

    document.getElementById("upload").addEventListener("change", function (e) {
      imageFile = e.target.files[0];
      if (imageFile) {
        const reader = new FileReader();
        reader.onload = function (e) {
          document.getElementById("original").src = e.target.result;
          document.getElementById("original").style.display = "block";
        };
        reader.readAsDataURL(imageFile);
      }
    });

    function submitImage() {
      if (!imageFile) return alert("Please upload an image.");

      const formData = new FormData();
      formData.append("image", imageFile);
      formData.append("deficiency", document.getElementById("type").value);

      fetch("/daltonize", {
        method: "POST",
        body: formData,
      })
        .then(res => res.blob())
        .then(blob => {
          const url = URL.createObjectURL(blob);
          const img = document.getElementById("daltonized");
          img.src = url;
          img.style.display = "block";
        });
    }
  </script>
</body>
</html>
